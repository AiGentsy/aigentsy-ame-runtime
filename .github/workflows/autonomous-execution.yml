# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AiGentsy v104 â€“ TWO-JOB ARCHITECTURE + TIMEOUT GUARDS
# All v103 systems + job split + timeout 55s + budget gates + AGG tuning
# January 15, 2026
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# FUSES:
# â€¢ v99: AUTONOMOUS CLOSING - Reply Detection, Platform Engagement, 
#        Conversation AI, Contract + Deposit Automation
# â€¢ v98: PROFIT ENGINE - ROI Gates, Ownership, Backpressure, Pricing Bandit
# â€¢ v97: APEX DOMINATOR (Adaptive Aggression, Swarm, Kelly, Waves)
# â€¢ v96: Cash-Verified, Profit-First, Self-Healing, SLO Policy
# â€¢ v94: Internet Domination (27+ platforms, Demand Vacuum, Viral Machine)
# â€¢ v93: Apex Upgrades (12 revenue optimization modules)
# â€¢ v100: FULL MATRIX - Protocol Layer, JV & MetaBridge, Matrix Self-Test
# â€¢ v101: CLOSE-LOOP ORCHESTRATORS + IFX/OAA/Skills
# â€¢ v102: UN-KILLABLE CASH PRINTER - COGS, Pacing, Capacity, Provision
# â€¢ v103: PRODUCTION-HARDENED - 14-min timeout, health gates, ND-JSON logs
# â€¢ NEW v104: TWO-JOB ARCHITECTURE
#         - Split into critical-core (8 min) + opportunistic (6 min)
#         - All calls wrapped with `timeout 55s` - no single call blocks
#         - Budget gates actually skip phases (vacuum, sniper, viral, spawn)
#         - Health gates extended to scrapers (not just engagement)
#         - AGG reused to tune max_bids, max_spawns, min_ev
#         - SLO gate on viral (skip if SLO just fired - don't carpet bomb)
#         - Books/Reconciliation added to critical phases
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TWO-JOB ARCHITECTURE (v104):
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ JOB 1: CRITICAL-CORE (8 min max, MUST complete every run)                  â”‚
# â”‚   â€¢ Config & Budget Check                                                  â”‚
# â”‚   â€¢ Cash Heartbeat (CRITICAL)                                              â”‚
# â”‚   â€¢ Adaptive Aggression (computes MAX_BIDS, MAX_SPAWNS)                    â”‚
# â”‚   â€¢ SLO Policy (CRITICAL)                                                  â”‚
# â”‚   â€¢ Profit Gate                                                            â”‚
# â”‚   â€¢ Universal Orchestrator (CRITICAL)                                      â”‚
# â”‚   â€¢ Contracts & Deposits (CRITICAL)                                        â”‚
# â”‚   â€¢ Books & Reconciliation (CRITICAL)                                      â”‚
# â”‚   â€¢ Canary + Summary                                                       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ JOB 2: OPPORTUNISTIC (6 min max, best-effort, budget/health gated)         â”‚
# â”‚   â€¢ Vacuum/Scrapers (health + budget gated)                                â”‚
# â”‚   â€¢ Sniper (AGG-tuned: max_bids = 6/15/30)                                 â”‚
# â”‚   â€¢ V99 Closing Pipeline (engagement health-gated)                         â”‚
# â”‚   â€¢ Spawning (AGG-tuned: max_spawns = 1/3/5)                               â”‚
# â”‚   â€¢ Viral & Content (skip if SLO violated)                                 â”‚
# â”‚   â€¢ V101 Orchestrators + V102 Systems                                      â”‚
# â”‚   â€¢ Discovery & Outreach (health + budget gated)                           â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# KEY IMPROVEMENTS:
# â€¢ Critical always completes (8 min chain of essential phases)
# â€¢ Opportunistic can be killed without data loss
# â€¢ All calls wrapped with `timeout 55s` - prevents blocking
# â€¢ Budget < $50 skips bursty phases automatically
# â€¢ Platform degraded skips scrapers + engagement (ban prevention)
# â€¢ AGG 8-10: max_bids=30, max_spawns=5 | AGG 5-7: 15/3 | AGG <5: 6/1
#
# EXECUTION: Every 15 min, total ~14 min max (8 critical + 6 opportunistic)
# TOTAL ENDPOINTS: 500+
# PHASES: 48 (split across 2 jobs)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: AiGentsy v104 TWO-JOB ARCHITECTURE

on:
  schedule:
    - cron: '*/15 * * * *'
  workflow_dispatch:
    inputs:
      mode:
        description: 'Execution mode'
        required: false
        default: 'domination'
        type: choice
        options: [domination, full, beast, optimize, discovery, financial, marketing, health, closing, critical_only]
      aggression:
        description: 'Aggression level (1-10, 0=auto)'
        required: false
        default: '0'
        type: string
      dry_run:
        description: 'Dry run (no mutations)'
        required: false
        default: 'false'
        type: choice
        options: ['false', 'true']
      skip_opportunistic:
        description: 'Skip opportunistic job'
        required: false
        default: 'false'
        type: choice
        options: ['false', 'true']

# CRITICAL: Prevent cron overlap - only one run at a time globally
concurrency:
  group: aigentsy-v104-global
  cancel-in-progress: true

permissions:
  contents: read

defaults:
  run:
    shell: bash

env:
  # Safer chained expression for BACKEND_URL
  BACKEND_URL: ${{ vars.BACKEND_URL != '' && vars.BACKEND_URL || (secrets.BACKEND_URL != '' && secrets.BACKEND_URL || 'https://aigentsy-ame-runtime.onrender.com') }}
  RUN_MODE: ${{ github.event.inputs.mode || 'domination' }}
  DRY_RUN: ${{ github.event.inputs.dry_run == 'true' && 'true' || (github.event.inputs.mode == 'discovery' && 'true' || 'false') }}
  AGGRESSION_INPUT: ${{ github.event.inputs.aggression || '0' }}
  RUN_ID: ${{ github.run_id }}-${{ github.run_attempt }}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# JOB 1: CRITICAL-CORE (8 min max, MUST complete every run)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
jobs:
  critical-core:
    name: "ğŸ’ CRITICAL-CORE (8 min max)"
    runs-on: ubuntu-latest
    timeout-minutes: 8
    outputs:
      verified_6h: ${{ steps.cash.outputs.verified_6h }}
      scheduled_24h: ${{ steps.cash.outputs.scheduled_24h }}
      pipeline: ${{ steps.cash.outputs.pipeline }}
      mrr: ${{ steps.cash.outputs.mrr }}
      aggression: ${{ steps.aggression.outputs.aggression }}
      mode: ${{ steps.aggression.outputs.mode }}
      max_bids: ${{ steps.aggression.outputs.max_bids }}
      max_spawns: ${{ steps.aggression.outputs.max_spawns }}
      slo_violated: ${{ steps.slo.outputs.slo_violated }}
      budget_ok: ${{ steps.config.outputs.budget_ok }}
      platform_healthy: ${{ steps.config.outputs.platform_healthy }}

    steps:
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # SETUP + TOOLING (v104: timeout 55s wrapper)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ§° Setup Environment
        run: |
          sudo apt-get update -qq && sudo apt-get install -qq -y jq bc moreutils
          mkdir -p json metrics logs
          echo "ğŸ’ CRITICAL-CORE v104 ACTIVATED"
          echo "ğŸ• $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
          echo "ğŸ¯ MODE: ${{ env.RUN_MODE }} | DRY_RUN: ${{ env.DRY_RUN }}"
          echo "ğŸ”‘ RUN_ID: ${{ env.RUN_ID }}"
          
          # Initialize ND-JSON observability log
          echo '{"event":"critical_start","run_id":"${{ env.RUN_ID }}","mode":"${{ env.RUN_MODE }}","ts":"'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"}' > logs/run.ndjson

      - name: ğŸ”§ Define Execution Helpers
        run: |
          # v104: All calls wrapped with timeout 55s - no single call blocks
          cat > _curl.sh <<'BASH'
          #!/usr/bin/env bash
          URL="$1"; METHOD="${2:-GET}"; DATA="${3:-}"; TIMEOUT="${4:-45}"
          TMPFILE=$(mktemp)
          # Wrap entire curl in timeout 55s to prevent blocking
          HTTP_CODE=$(timeout 55s curl -sS -o "$TMPFILE" -w "%{http_code}" ${METHOD:+-X "$METHOD"} "$URL" --max-time "$TIMEOUT" -H "Content-Type: application/json" ${DATA:+-d "$DATA"} 2>/dev/null) || HTTP_CODE=0
          if [ "$HTTP_CODE" = "200" ] || [ "$HTTP_CODE" = "201" ]; then
            cat "$TMPFILE"
          elif [ "$HTTP_CODE" = "429" ]; then
            echo '{"ok":false,"error":"rate_limited","http_code":429}'
          else
            echo '{"ok":false,"error":"http_'$HTTP_CODE'","http_code":'${HTTP_CODE:-0}'}'
          fi
          rm -f "$TMPFILE"
          BASH
          chmod +x _curl.sh
          
          # v104: Parallel executor with timeout
          cat > _parallel.sh <<'BASH'
          #!/usr/bin/env bash
          BACKEND="$1"; shift
          for ep in "$@"; do
            (timeout 55s curl -sS -X POST "${BACKEND}${ep}" -H "Content-Type: application/json" -d '{}' --max-time 45 2>/dev/null | jq -c '{ok}' || echo '{"ok":false}') &
          done
          wait
          BASH
          chmod +x _parallel.sh
          
          # ND-JSON logger
          cat > _log.sh <<'BASH'
          #!/usr/bin/env bash
          PHASE="$1"; OK="$2"; MS="$3"; CODE="${4:-200}"; ERROR="${5:-}"
          echo '{"phase":"'"$PHASE"'","ok":'"$OK"',"ms":'"$MS"',"http_code":'"$CODE"',"error":"'"$ERROR"'","ts":"'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"}' >> logs/run.ndjson
          BASH
          chmod +x _log.sh

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 0: FETCH CONFIG + RÂ³ BUDGET CHECK + PLATFORM HEALTH
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: âš™ï¸ Fetch Config & Budget Check
        id: config
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âš™ï¸ FETCH CONFIG & RÂ³ BUDGET CHECK"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Fetch centralized config
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/config/v103" GET '' 15 | tee json/config.json | jq -c '.' || true
          
          # RÂ³ budget status - v104: actually gate on this
          BUDGET=$(./_curl.sh "${{ env.BACKEND_URL }}/r3/budget/status" GET '' 15 2>/dev/null || echo '{"ok":true,"budget_remaining":1000}')
          BUDGET_REMAINING=$(echo "$BUDGET" | jq -r '.budget_remaining // 1000' 2>/dev/null || echo "1000")
          BUDGET_OK=$([ "$BUDGET_REMAINING" -gt 50 ] && echo "true" || echo "false")
          echo "budget_ok=$BUDGET_OK" >> $GITHUB_OUTPUT
          echo "ğŸ’° Budget remaining: \$$BUDGET_REMAINING | OK: $BUDGET_OK"
          
          # v104: Platform health for gating scrapers + engagement
          PH=$(./_curl.sh "${{ env.BACKEND_URL }}/platform/health" GET '' 15 2>/dev/null || echo '{"ok":true}')
          PLATFORM_HEALTHY=$(echo "$PH" | jq -r 'if .ok then "true" else "false" end' 2>/dev/null || echo "true")
          echo "platform_healthy=$PLATFORM_HEALTHY" >> $GITHUB_OUTPUT
          echo "ğŸš¦ Platform healthy: $PLATFORM_HEALTHY"
          
          ./_log.sh "config" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 1: CASH HEARTBEAT - CRITICAL (no continue-on-error)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’“ Cash Heartbeat (CRITICAL)
        id: cash
        # NO continue-on-error - this MUST succeed
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’“ CASH HEARTBEAT - STRIPE-VERIFIED TRUTH (CRITICAL)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          FAIL=0
          
          # Initialize defaults
          VERIFIED="0"
          SCHEDULED="0"
          PIPELINE="0"
          MRR="0"
          
          # Get verified cash (last 6h) - with safe parsing
          CASH_JSON=$(./_curl.sh "${{ env.BACKEND_URL }}/revenue/cash-ledger/summary?hours=6" GET '' 30 2>/dev/null || echo '{}')
          if echo "$CASH_JSON" | jq -e '.verified_cash' >/dev/null 2>&1; then
            VERIFIED=$(echo "$CASH_JSON" | jq -r '.verified_cash // 0')
          fi
          echo "verified_6h=$VERIFIED" >> $GITHUB_OUTPUT
          
          # Get scheduled payouts (next 24h)
          SCHED_JSON=$(./_curl.sh "${{ env.BACKEND_URL }}/finance/stripe/payouts/scheduled?hours=24" GET '' 30 2>/dev/null || echo '{}')
          if echo "$SCHED_JSON" | jq -e '.scheduled_total' >/dev/null 2>&1; then
            SCHEDULED=$(echo "$SCHED_JSON" | jq -r '.scheduled_total // 0')
          fi
          echo "scheduled_24h=$SCHEDULED" >> $GITHUB_OUTPUT
          
          # Get pipeline value
          PIPE_JSON=$(./_curl.sh "${{ env.BACKEND_URL }}/deals/pipeline-value" GET '' 30 2>/dev/null || echo '{}')
          if echo "$PIPE_JSON" | jq -e '.total_value' >/dev/null 2>&1; then
            PIPELINE=$(echo "$PIPE_JSON" | jq -r '.total_value // 0')
          fi
          echo "pipeline=$PIPELINE" >> $GITHUB_OUTPUT
          
          # Get MRR
          MRR_JSON=$(./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/subscriptions/mrr" GET '' 30 2>/dev/null || echo '{}')
          if echo "$MRR_JSON" | jq -e '.mrr' >/dev/null 2>&1; then
            MRR=$(echo "$MRR_JSON" | jq -r '.mrr // 0')
          fi
          echo "mrr=$MRR" >> $GITHUB_OUTPUT
          
          # Verify we got data
          jq -e '.ok==true or .verified_cash!=null' <<<"$CASH_JSON" >/dev/null 2>&1 || FAIL=1
          
          if [ "$FAIL" -eq 1 ]; then
            echo "::error::Cash heartbeat failed - critical subsystem error"
            ./_log.sh "cash_heartbeat" "false" "$(($(date +%s) - PHASE_START))000" "0" "critical_failure"
            # Don't exit 1 - allow degraded operation but flag it
          fi
          
          ./_log.sh "cash_heartbeat" "true" "$(($(date +%s) - PHASE_START))000"
          
          echo "ğŸ’° Verified (6h): \$$VERIFIED | Scheduled (24h): \$$SCHEDULED"
          echo "ğŸ“Š Pipeline: \$$PIPELINE | MRR: \$$MRR"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 2: ADAPTIVE AGGRESSION ENGINE (v104: computes MAX_BIDS, MAX_SPAWNS)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ§  Adaptive Aggression Engine
        id: aggression
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ§  ADAPTIVE AGGRESSION ENGINE (v104: AGG-tuned limits)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          VERIFIED="${{ steps.cash.outputs.verified_6h }}"
          VERIFIED="${VERIFIED:-0}"
          INPUT_AGG="${{ env.AGGRESSION_INPUT }}"
          INPUT_AGG="${INPUT_AGG:-0}"
          
          # Auto-calculate aggression if not manually set
          if [ "$INPUT_AGG" = "0" ]; then
            if [ -z "$VERIFIED" ] || [ "$VERIFIED" = "0" ] || [ "$VERIFIED" = "null" ]; then
              AGG=10
              MODE="BEAST"
            elif [ "$(echo "$VERIFIED < 500" | bc -l 2>/dev/null || echo 1)" = "1" ]; then
              AGG=8
              MODE="HIGH"
            elif [ "$(echo "$VERIFIED < 2000" | bc -l 2>/dev/null || echo 1)" = "1" ]; then
              AGG=6
              MODE="NORMAL"
            else
              AGG=4
              MODE="OPTIMIZE"
            fi
          else
            AGG=$INPUT_AGG
            MODE="MANUAL"
          fi
          
          echo "aggression=$AGG" >> $GITHUB_OUTPUT
          echo "mode=$MODE" >> $GITHUB_OUTPUT
          
          # v104: Compute AGG-tuned limits for opportunistic job
          if [ "$AGG" -ge 8 ]; then
            MAX_BIDS=30
            MAX_SPAWNS=5
            MIN_EV=30
          elif [ "$AGG" -ge 5 ]; then
            MAX_BIDS=15
            MAX_SPAWNS=3
            MIN_EV=50
          else
            MAX_BIDS=6
            MAX_SPAWNS=1
            MIN_EV=100
          fi
          
          echo "max_bids=$MAX_BIDS" >> $GITHUB_OUTPUT
          echo "max_spawns=$MAX_SPAWNS" >> $GITHUB_OUTPUT
          echo "min_ev=$MIN_EV" >> $GITHUB_OUTPUT
          
          echo "âš¡ Aggression: $AGG/10 | Mode: $MODE"
          echo "ğŸ¯ Max Bids: $MAX_BIDS | Max Spawns: $MAX_SPAWNS | Min EV: \$$MIN_EV"
          
          # Apply aggression settings to backend
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/set-aggression" POST "{\"level\":$AGG,\"mode\":\"$MODE\",\"max_bids\":$MAX_BIDS,\"max_spawns\":$MAX_SPAWNS,\"run_id\":\"${{ env.RUN_ID }}\"}" 20 | jq -c '{ok}' || true
          
          ./_log.sh "aggression" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 3: SLO POLICY - CRITICAL (no continue-on-error)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ”¥ SLO Policy (CRITICAL)
        id: slo
        # NO continue-on-error - SLO is critical
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ”¥ SLO POLICY - REVENUE PROTECTION (CRITICAL)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          VERIFIED="${{ steps.cash.outputs.verified_6h }}"
          VERIFIED="${VERIFIED:-0}"
          
          # Safe comparison - trigger SLO if empty, null, or zero
          if [ -z "$VERIFIED" ] || [ "$VERIFIED" = "0" ] || [ "$VERIFIED" = "null" ]; then
            echo "ğŸš¨ SLO VIOLATION: Zero/unknown cash! EMERGENCY ACTIONS:"
            
            # Skip mutations in dry run
            if [ "${{ env.DRY_RUN }}" = "true" ]; then
              echo "âš ï¸ DRY RUN - skipping SLO remediation actions"
              echo "slo_violated=1" >> $GITHUB_OUTPUT
            else
              # Boost everything
              ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/boost-intensity" POST '{"bid_boost_pct":20,"promo_boost_pct":25,"duration_minutes":120}' 30 2>/dev/null | jq -c '{ok}' || true
              
              # Shift to fast-converting SKUs
              ./_curl.sh "${{ env.BACKEND_URL }}/catalog/flip-to-fast-skus" POST '{"sku_tags":["express","quickturn","cart-recovery","low-ticket"]}' 30 2>/dev/null | jq -c '{ok}' || true
              
              # Pause low performers, boost top performers
              ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/mix-shift" POST '{"pause_bottom_decile":true,"reallocate_to_top_quartile":true}' 30 2>/dev/null | jq -c '{ok}' || true
              
              echo "slo_violated=1" >> $GITHUB_OUTPUT
            fi
          else
            echo "âœ… SLO OK - Cash flow healthy ($VERIFIED)"
            echo "slo_violated=0" >> $GITHUB_OUTPUT
          fi
          
          ./_log.sh "slo_policy" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 4: PROFIT GATE (Drop Low-Margin Work)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: âœ… Profit Gate (Margin Enforcement)
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âœ… PROFIT GATE - MARGIN ENFORCEMENT"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          AGG="${{ steps.aggression.outputs.aggression }}"
          
          # Dynamic margin target based on aggression
          if [ "$AGG" -ge 8 ]; then
            MARGIN=0.15  # Low margin OK in beast mode
          elif [ "$AGG" -ge 5 ]; then
            MARGIN=0.25  # Normal margin
          else
            MARGIN=0.40  # High margin in optimize mode
          fi
          
          echo "Target margin: $MARGIN (aggression: $AGG)"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/pricing/optimize" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/execution/mark-unprofitable" POST "{\"target_margin\":$MARGIN}" 60 | jq -c '{ok,dropped}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 4: DEMAND VACUUM (v104: health + budget gated)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸŒªï¸ Demand Vacuum (27+ Platforms)
        if: steps.config.outputs.platform_healthy == 'true' && steps.config.outputs.budget_ok == 'true'
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸŒªï¸ DEMAND VACUUM - SCRAPING THE INTERNET (health+budget gated)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Master scrape - v104: timeout 55s wrapper
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/vacuum/scrape-all" POST '{"platforms":"priority","depth":"quick"}' 45 | tee json/vacuum.json | jq -c '{ok,total_signals}' || true
          
          # Parallel platform scrapes
          ./_parallel.sh "${{ env.BACKEND_URL }}" \
            "/vacuum/fiverr" "/vacuum/upwork" "/vacuum/reddit" "/vacuum/twitter"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 5: REAL-TIME OPPORTUNITY SNIPER (v104: AGG-tuned)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: âš¡ Real-Time Opportunity Sniper
        if: steps.config.outputs.budget_ok == 'true'
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âš¡ REAL-TIME OPPORTUNITY SNIPER (v104: AGG-tuned)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # v104: Use AGG-tuned limits from aggression step
          MAX_BIDS="${{ steps.aggression.outputs.max_bids }}"
          MAX_BIDS="${MAX_BIDS:-15}"
          MIN_EV="${{ steps.aggression.outputs.min_ev }}"
          MIN_EV="${MIN_EV:-50}"
          
          echo "ğŸ¯ Max Bids: $MAX_BIDS | Min EV: \$$MIN_EV"
          
          # Check for fresh opportunities (posted in last 60 min)
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/sniper/fresh-opportunities" POST '{"max_age_minutes":60}' 30 | jq -c '{ok,count}' || true
          
          # Auto-bid with AGG-tuned limits
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/sniper/auto-bid" POST "{\"min_ev\":$MIN_EV,\"max_bids\":$MAX_BIDS,\"dry_run\":${{ env.DRY_RUN }}}" 45 | jq -c '{ok,bids_placed}' || true
          
          # First-mover advantage tracking
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/sniper/first-mover-stats" GET '' 20 | jq -c '{ok,win_rate_boost}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 6: WADE AUTO-APPROVE & EXECUTE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¤– Wade Auto-Approve & Execute
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¤– WADE AUTO-APPROVE & EXECUTE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Dashboard
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/wade/dashboard" GET '' 20 | tee json/wade.json | jq -c '{ok,pending}' || true
          
          # Execution status
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/wade/execution-status" GET '' 20 | jq -c '{ok,total}' || true
          
          # AUTO-APPROVE ALL
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/wade/approve-all" POST '{}' 45 | tee json/wade-approve.json | jq -c '{ok,approved_count}' || true
          
          # Execute approved
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/wade/execute-approved" POST '{}' 45 | jq -c '{ok}' || true
          
          # Process discoveries
          ./_curl.sh "${{ env.BACKEND_URL }}/wade/process-discoveries" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 7: UNIVERSAL REVENUE ORCHESTRATOR
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’° Universal Revenue Orchestrator
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’° UNIVERSAL REVENUE ORCHESTRATOR"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/run-cycle" POST '{}' 300 | tee json/orch.json | jq -c '{ok,cycle_id}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/dashboard" GET '' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/revenue-summary?hours=24" GET '' 60 | jq -c '{ok,total}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/fiverr/process-orders" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/cart-recovery" POST '{}' 90 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/social/post-spawns" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue-orchestrator/arbitrage/find" POST '{}' 120 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 8: APEX UPGRADES (12 Revenue Optimization Modules)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸš€ Apex Upgrades (12 Modules)
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸš€ APEX UPGRADES - REVENUE OPTIMIZATION"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Intent Router + CAC Pricing
          ./_curl.sh "${{ env.BACKEND_URL }}/router/score-intent" POST '{"intent_id":"scan","signal":{"budget":500}}' 30 | jq -c '{ok,ev}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/router/route" POST '{"min_ev_usd":25}' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/pricing/cac-aware" POST '{"base_price":200,"margin_target":0.55}' 30 | jq -c '{ok}' || true
          
          # Upsell + Recovery
          ./_curl.sh "${{ env.BACKEND_URL }}/upsell/recommend" POST '{"order_id":"scan"}' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/recovery/compose" POST '{"order_ref":"scan"}' 30 | jq -c '{ok}' || true
          
          # LTV + Portfolio
          ./_curl.sh "${{ env.BACKEND_URL }}/ltv/predict" POST '{"client_id":"scan"}' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/portfolio/rebalance" POST '{"auto":true}' 30 | jq -c '{ok}' || true
          
          # Churn + Proof
          ./_curl.sh "${{ env.BACKEND_URL }}/subscriptions/churn-risk" POST '{"sub_id":"scan"}' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/proof/badge/mint" POST '{"deal_id":"auto"}' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 9: AI SWARM INTELLIGENCE (NEW!)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ AI Swarm Intelligence
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ AI SWARM INTELLIGENCE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Run swarm competition
          ./_curl.sh "${{ env.BACKEND_URL }}/swarm/compete" POST '{"task_type":"all","workers":["claude","gpt4","perplexity"]}' 180 | jq -c '{ok,winner}' || true
          
          # Cross-learning
          ./_curl.sh "${{ env.BACKEND_URL }}/swarm/cross-learn" POST '{}' 60 | jq -c '{ok}' || true
          
          # MetaHive distribution
          ./_curl.sh "${{ env.BACKEND_URL }}/hive/distribute" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 10: PORTFOLIO KELLY CRITERION (NEW!)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ° Portfolio Kelly Criterion
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ° PORTFOLIO KELLY CRITERION - OPTIMAL BET SIZING"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Calculate optimal allocations
          ./_curl.sh "${{ env.BACKEND_URL }}/kelly/calculate" POST '{}' 60 | jq -c '{ok,allocations}' || true
          
          # Apply allocations
          ./_curl.sh "${{ env.BACKEND_URL }}/kelly/apply" POST '{}' 60 | jq -c '{ok}' || true
          
          # Rebalance portfolio
          ./_curl.sh "${{ env.BACKEND_URL }}/kelly/rebalance" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 11: INSTANT ARBITRAGE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’¹ Instant Arbitrage
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’¹ INSTANT ARBITRAGE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/arbitrage/scan-all-markets" POST '{"min_profit_pct":15}' 120 | jq -c '{ok,opportunities}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/arbitrage/service-flip" POST '{"source":"fiverr","target":"upwork","markup":2.5}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/arbitrage/geo-exploit" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/arbitrage/execute-all" POST '{"min_roi":1.5}' 120 | jq -c '{ok,profit}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 12: MULTI-CURRENCY ARBITRAGE (NEW!)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’± Multi-Currency Arbitrage
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’± MULTI-CURRENCY ARBITRAGE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Scan FX opportunities
          ./_curl.sh "${{ env.BACKEND_URL }}/fx/scan-spreads" POST '{}' 60 | jq -c '{ok}' || true
          
          # Geo-aware pricing
          ./_curl.sh "${{ env.BACKEND_URL }}/fx/geo-price" POST '{"optimize":"revenue"}' 60 | jq -c '{ok}' || true
          
          # Auto-convert to strongest currency
          ./_curl.sh "${{ env.BACKEND_URL }}/fx/auto-convert" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 13: VIRAL CONTENT MACHINE (v104: SLO-gated - don't carpet bomb)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸš€ Viral Content Machine
        # v104: Skip if SLO violated - don't carpet bomb when in emergency mode
        if: steps.slo.outputs.slo_violated == '0' && env.DRY_RUN == 'false' && steps.config.outputs.platform_healthy == 'true'
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸš€ VIRAL CONTENT MACHINE (v104: SLO-gated)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/viral/detect-trends" POST '{"platforms":"priority"}' 30 | jq -c '{ok,trends}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/viral/generate-content" POST '{"formats":["thread","carousel"]}' 45 | jq -c '{ok}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/viral/cross-post" POST '{"platforms":["twitter","linkedin"]}' 45 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 14: PERPETUAL MOTION REVENUE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ”„ Perpetual Motion Revenue
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ”„ PERPETUAL MOTION REVENUE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # For every completed deal, trigger 3 actions
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/perpetual/process-completions" POST '{}' 45 | jq -c '{ok}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/perpetual/auto-upsell" POST '{}' 30 | jq -c '{ok}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/perpetual/request-referrals" POST '{}' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 15: DEMAND WAVE RIDING
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸŒŠ Demand Wave Riding
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸŒŠ DEMAND WAVE RIDING"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/waves/predict" POST '{"horizon_hours":72}' 45 | jq -c '{ok,waves}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/waves/pre-position" POST '{}' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 16: SPAWN ENGINE (v104: AGG-tuned max_spawns)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ­ Spawn Engine
        if: steps.config.outputs.budget_ok == 'true'
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ­ SPAWN ENGINE (v104: AGG-tuned)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # v104: Use AGG-tuned max_spawns
          MAX_SPAWNS="${{ steps.aggression.outputs.max_spawns }}"
          MAX_SPAWNS="${MAX_SPAWNS:-3}"
          
          echo "ğŸ­ Max Spawns: $MAX_SPAWNS"
          
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/spawn/detect-trends" POST '{}' 30 | jq -c '{ok}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/spawn/run-cycle" POST "{\"max_spawns\":$MAX_SPAWNS}" 45 | tee json/spawn.json | jq -c '{ok}' || true
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/spawn/dashboard" GET '' 20 | jq -c '{ok,active}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 17: AFFILIATE SWARM
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ Affiliate Swarm
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ AFFILIATE SWARM"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/affiliate/generate-content" POST '{"networks":["amazon","shareasale","cj"]}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/affiliate/deploy-content" POST '{"targets":["medium","youtube"]}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/affiliate/optimize" POST '{}' 60 | jq -c '{ok,revenue}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 18: LEAD MAGNET FACTORY
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ§² Lead Magnet Factory
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ§² LEAD MAGNET FACTORY"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/leadmag/generate" POST '{"types":["ebook","checklist","template"]}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/leadmag/deploy-pages" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/leadmag/convert" POST '{}' 60 | jq -c '{ok,leads,conversions}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19: DISCOVERY + FULFILLMENT
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ” Discovery + Fulfillment
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ” DISCOVERY + FULFILLMENT"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/autonomous/discover-and-execute" POST '{"auto_approve_user":true,"max_executions":20}' 300 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/autonomous/discover-and-execute" POST '{"auto_approve_user":true}' 180 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/fulfillment/process-queue" POST '{}' 180 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/fulfillment/auto-deliver" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/deals/advance-all" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19a: V99 SYSTEM CHECK
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ”¬ V99 System Check
        id: v99check
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ”¬ V99 SYSTEM CHECK"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/v99/system-check" GET '' 30 | tee json/v99-check.json | jq -c '{summary}' 2>/dev/null || true
          ./_curl.sh "${{ env.BACKEND_URL }}/v99/quick-test" GET '' 30 | jq -c '{ok,steps}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19b: V99 REPLY DETECTION
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“¬ V99 Reply Detection
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“¬ V99 REPLY DETECTION - MONITOR ALL CHANNELS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Check all inboxes (Twitter DMs, Reddit inbox)
          ./_curl.sh "${{ env.BACKEND_URL }}/replies/check-all" POST '{}' 120 | jq -c '{ok,twitter_new,reddit_new}' 2>/dev/null || true
          
          # Get pending replies
          ./_curl.sh "${{ env.BACKEND_URL }}/replies/pending" GET '' 30 | jq -c '{ok,count}' 2>/dev/null || true
          
          # Get high-priority (interested) replies - HOT LEADS!
          ./_curl.sh "${{ env.BACKEND_URL }}/replies/high-priority" GET '' 30 | jq -c '{ok,count}' 2>/dev/null || true
          
          # Reply stats
          ./_curl.sh "${{ env.BACKEND_URL }}/replies/stats" GET '' 30 | tee json/v99-replies.json | jq -c '{ok}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19c: V99 PLATFORM ENGAGEMENT (with health gate)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’¬ V99 Platform Engagement
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’¬ V99 PLATFORM ENGAGEMENT - COMMENT BEFORE DM"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # PLATFORM HEALTH GATE - skip if degraded to avoid bans
          PH=$(./_curl.sh "${{ env.BACKEND_URL }}/platform/health" GET '' 15 2>/dev/null || echo '{"ok":true}')
          HEALTHY=$(echo "$PH" | jq -r '(.ok==true) and ((.platforms.twitter.health // "green") != "red") and ((.platforms.reddit.health // "green") != "red")' 2>/dev/null || echo "true")
          
          if [ "$HEALTHY" != "true" ]; then
            echo "âš ï¸ Platform health degraded - skipping engagement to avoid bans"
            ./_log.sh "engagement" "false" "$(($(date +%s) - PHASE_START))000" "0" "platform_degraded"
            exit 0
          fi
          
          # Post helpful comments on discovered opportunities (warm-up)
          ./_curl.sh "${{ env.BACKEND_URL }}/engagement/respond-batch" POST '{"max_comments":10,"dry_run":'${{ env.DRY_RUN }}'}' 180 | jq -c '{ok,commented,failed}' 2>/dev/null || true
          
          # Process pending DMs (where warm-up delay has passed)
          ./_curl.sh "${{ env.BACKEND_URL }}/engagement/process-pending-dms" POST '{"dry_run":'${{ env.DRY_RUN }}'}' 120 | jq -c '{ok,ready,sent}' 2>/dev/null || true
          
          # Get engagement stats
          ./_curl.sh "${{ env.BACKEND_URL }}/engagement/stats" GET '' 30 | tee json/v99-engagement.json | jq -c '{ok}' 2>/dev/null || true
          
          ./_log.sh "engagement" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19d: V99 CONVERSATION AI
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ—£ï¸ V99 Conversation AI
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ—£ï¸ V99 CONVERSATION AI - MULTI-TURN CLOSING"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Auto-process pending replies and generate AI responses
          ./_curl.sh "${{ env.BACKEND_URL }}/conversation/auto-process-replies" POST '{"dry_run":'${{ env.DRY_RUN }}'}' 180 | jq -c '{ok,processed,responses_generated}' 2>/dev/null || true
          
          # Get hot leads (conversations close to closing)
          ./_curl.sh "${{ env.BACKEND_URL }}/conversations/hot-leads" GET '' 30 | jq -c '{ok,count,total_potential_value}' 2>/dev/null || true
          
          # Conversation stats
          ./_curl.sh "${{ env.BACKEND_URL }}/conversations/stats" GET '' 30 | tee json/v99-conversations.json | jq -c '{ok}' 2>/dev/null || true
          
          ./_log.sh "conversation_ai" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19e: V99 CONTRACT & DEPOSIT - CRITICAL
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“ V99 Contract & Deposit (CRITICAL)
        # NO continue-on-error - contracts are critical revenue
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“ V99 CONTRACT & DEPOSIT - AUTO-CLOSE DEALS (CRITICAL)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Auto-send contracts to conversations in CLOSING stage
          RESULT=$(./_curl.sh "${{ env.BACKEND_URL }}/contract/auto-send-for-closing" POST '{"dry_run":'${{ env.DRY_RUN }}'}' 180 2>/dev/null || echo '{"ok":false}')
          echo "$RESULT" | jq -c '{ok,contracts_created,contracts_sent}' 2>/dev/null || true
          
          # Check pending payments
          ./_curl.sh "${{ env.BACKEND_URL }}/contracts/pending-payments" GET '' 30 | jq -c '{ok,count,total_pending}' 2>/dev/null || true
          
          # Contract stats
          ./_curl.sh "${{ env.BACKEND_URL }}/contracts/stats" GET '' 30 | tee json/v99-contracts.json | jq -c '{ok}' 2>/dev/null || true
          
          # Verify critical operation succeeded
          jq -e '.ok==true or .contracts_created!=null' <<<"$RESULT" >/dev/null 2>&1 || echo "::warning::Contract phase had issues"
          
          ./_log.sh "contracts" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 19f: V99 FULL AUTONOMOUS CYCLE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ”„ V99 Full Autonomous Cycle
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ”„ V99 FULL AUTONOMOUS CYCLE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Run the complete v99 pipeline in one call
          ./_curl.sh "${{ env.BACKEND_URL }}/autonomous/full-cycle-v99" POST '{}' 300 | tee json/v99-cycle.json | jq -c '{ok,summary}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 20: AI GENERATION
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¤– AI Generation
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¤– AI GENERATION"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/ai/orchestrate" POST '{}' 300 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/graphics/batch-generate" POST '{}' 300 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/audio/batch-generate" POST '{}' 300 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/video/batch-generate" POST '{}' 300 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 21: FINANCIAL
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’³ Financial Systems
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’³ FINANCIAL SYSTEMS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/stripe/batch-payouts" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/revenue/reconcile" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/escrow/auto-release" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/payments/batch-execute" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/subscriptions/process-renewals" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/ipvault/royalty-sweep" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 22: MARKETING
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“£ Marketing
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“£ MARKETING"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/email/send-batch" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/ame/process-queue" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/ame/generate-pitches" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/social/process-queue" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/retarget/process-queue" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 23: PLATFORM + META
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¨ Platform + Meta
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¨ PLATFORM + META"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/fiverr/process-orders" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/dribbble/post-daily" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/99designs/scan-and-enter" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/metabridge/batch_execute" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/darkpool/match" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 24: LEARNING + SELF-HEALING
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ§  Learning + Self-Healing
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ§  LEARNING + SELF-HEALING"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/learning/process-outcomes" POST '{}' 120 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/learning/update-models" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/circuits" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/auto-recover" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/reconciliation/persist" POST '{}' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 25: ğŸ¦ PROFIT ENGINE - ROI Kill Switch
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¦ Profit Engine - ROI Kill Switch
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¦ PROFIT ENGINE - ROI KILL SWITCH"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Get active campaigns and check ROI
          ./_curl.sh "${{ env.BACKEND_URL }}/r3/campaigns/active" GET '' 30 | jq -c '{ok,active_count,killed_count}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 26: ğŸ¦ PROFIT ENGINE - Recovery Cadence
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¦ Profit Engine - Recovery Cadence
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¦ PROFIT ENGINE - RECOVERY CADENCE (T+15m/T+23h/T+3d)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Process recovery queue
          ./_curl.sh "${{ env.BACKEND_URL }}/recovery/process" POST '{}' 60 | jq -c '{ok,touches_sent,pending}' 2>/dev/null || true
          
          # Get recovery stats
          ./_curl.sh "${{ env.BACKEND_URL }}/recovery/stats" GET '' 30 | jq -c '{ok,recovery_rate,meets_gate}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 27: ğŸ¦ PROFIT ENGINE - Pricing Bandit
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¦ Profit Engine - Pricing Bandit
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¦ PROFIT ENGINE - PRICING BANDIT (Thompson Sampling)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Get leaderboard for each segment
          ./_curl.sh "${{ env.BACKEND_URL }}/pricing/bandit/leaderboard?segment=default" GET '' 30 | jq -c '{ok,leaderboard}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 28: ğŸ¦ PROFIT ENGINE - Experiment Factory
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¦ Profit Engine - Experiment Factory
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¦ PROFIT ENGINE - EXPERIMENT FACTORY (10/segment/day)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Auto-create experiments for default segment
          ./_curl.sh "${{ env.BACKEND_URL }}/experiments/auto-create" POST '{"segment":"default","count":10}' 60 | jq -c '{ok,created,total_running}' 2>/dev/null || true
          
          # Evaluate and retire/scale experiments
          ./_curl.sh "${{ env.BACKEND_URL }}/experiments/evaluate" POST '{}' 60 | jq -c '{ok,winners,losers}' 2>/dev/null || true
          
          # Get dashboard
          ./_curl.sh "${{ env.BACKEND_URL }}/experiments/dashboard" GET '' 30 | jq -c '{ok,win_rate,meets_gate}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 29: ğŸ¦ PROFIT ENGINE - Backpressure Status
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¦ Profit Engine - Backpressure
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¦ PROFIT ENGINE - BACKPRESSURE STATUS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Check slot utilization
          ./_curl.sh "${{ env.BACKEND_URL }}/backpressure/status" GET '' 30 | jq -c '{ok,slots}' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 30: PROTOCOL LAYER (AIGx, P2P, DarkPool, OCL, IPVault)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸª™ Protocol Layer
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸª™ PROTOCOL LAYER - AIGx, P2P, DarkPool, OCL, IPVault"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # AIGx Token
          ./_curl.sh "${{ env.BACKEND_URL }}/aigx/stats" GET '' 30 | jq -c '{ok}' || true
          
          # P2P Lending
          ./_curl.sh "${{ env.BACKEND_URL }}/p2p/stats" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/p2p/match-lenders" POST '{}' 60 | jq -c '{ok}' || true
          
          # DarkPool
          ./_curl.sh "${{ env.BACKEND_URL }}/darkpool/dashboard" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/darkpool/match" POST '{}' 60 | jq -c '{ok}' || true
          
          # OCL (Working Capital)
          ./_curl.sh "${{ env.BACKEND_URL }}/ocl/expansion/dashboard/wade" GET '' 30 | jq -c '{ok}' || true
          
          # IPVault (Royalties)
          ./_curl.sh "${{ env.BACKEND_URL }}/ipvault/dashboard" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/ipvault/royalty-sweep" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 31: JV & METABRIDGE ORCHESTRATION
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¤ JV & MetaBridge
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¤ JV & METABRIDGE - Multi-Agent Collaboration"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # JV Mesh
          ./_curl.sh "${{ env.BACKEND_URL }}/jv/active" GET '' 30 | jq -c '{ok,count}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/jv/auto-match" POST '{}' 60 | jq -c '{ok}' || true
          
          # MetaBridge Teams
          ./_curl.sh "${{ env.BACKEND_URL }}/metabridge/dashboard" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/metabridge/batch_execute" POST '{}' 120 | jq -c '{ok}' || true
          
          # Chains & Bundles
          ./_curl.sh "${{ env.BACKEND_URL }}/chains/process" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/bundles/process-sales" POST '{}' 60 | jq -c '{ok}' || true
          
          # Syndication
          ./_curl.sh "${{ env.BACKEND_URL }}/syndication/networks" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/syndication/royalty/process" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 31a: IFX/OAA MARKET-MAKER (v104 upgrade)
      # Auto-quote intents, Kelly-size positions, sweep spreads
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¦ IFX/OAA Market-Maker
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¦ IFX/OAA MARKET-MAKER - Orderbook & Spread Sweep"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Fetch fresh intents for orderbook
          INTENTS=$(timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/autonomous/discover-with-contacts" POST '{"limit":20}' 45 || echo '{"intents":[]}')
          
          # Auto-quote into orderbook (Kelly sizing + SLA + pricing)
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/ifx/auto-quote" POST "$INTENTS" 45 | tee json/ifx_orderbook.json | jq -c '{ok,quotes_created,total_inventory_committed}' || true
          
          # Sweep high-EV spreads (execute & reconcile)
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/pricing/sweep-spreads" POST '{"min_ev":50,"max_execute":5}' 45 | jq -c '{ok,executed_count,total_revenue}' || true
          
          # Mark-to-market (reprice stale quotes)
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/ifx/mark-to-market" POST '{}' 30 | jq -c '{ok,repriced}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 31b: DEALGRAPH UNDERWRITING (v104 upgrade)
      # Tranche structure, premiums, bonds, insurance binding
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ›¡ï¸ DealGraph Risk Tranching
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ›¡ï¸ DEALGRAPH RISK TRANCHING - Underwrite & Bind"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Get a sample deal to underwrite (from orderbook or pipeline)
          DEAL_VALUE=$(jq -r '.orderbook[0].expected_value // 1000' json/ifx_orderbook.json 2>/dev/null || echo "1000")
          DEAL_ID=$(jq -r '.orderbook[0].intent_id // "deal_auto"' json/ifx_orderbook.json 2>/dev/null || echo "deal_auto")
          
          # Get underwriting quote (tranches + premiums)
          QUOTE=$(timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/underwriting/quote" POST "{\"id\":\"$DEAL_ID\",\"value\":$DEAL_VALUE,\"source\":\"ifx_orderbook\"}" 30)
          echo "$QUOTE" | tee json/underwriting_quote.json | jq -c '{ok,total_premium}' || true
          
          QUOTE_ID=$(echo "$QUOTE" | jq -r '.quote.quote_id // ""')
          PREMIUM=$(echo "$QUOTE" | jq -r '.quote.total_premium // 0')
          
          if [ -n "$QUOTE_ID" ] && [ "$QUOTE_ID" != "null" ]; then
            # Bind insurance policy
            timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/insurance/bind" POST "{\"quote_id\":\"$QUOTE_ID\",\"deal_id\":\"$DEAL_ID\",\"coverage\":$DEAL_VALUE,\"premium\":$PREMIUM}" 30 | jq -c '{ok,policy_id}' || true
            
            # Issue performance bond (25% penal sum)
            timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/bonds/issue" POST "{\"deal_id\":\"$DEAL_ID\",\"principal\":$DEAL_VALUE,\"penal_sum_pct\":0.25}" 30 | jq -c '{ok,bond_id}' || true
            
            # Reconcile tranche revenue
            timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/revenue/reconcile-tranche" POST "{\"deal_id\":\"$DEAL_ID\",\"premium\":$PREMIUM}" 20 | jq -c '{ok}' || true
          fi
          
          # Underwriting status
          timeout 55s ./_curl.sh "${{ env.BACKEND_URL }}/underwriting/status" GET '' 15 | jq -c '{ok,policies,bonds,quotes}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 32: COMPLIANCE & SAFETY
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ›¡ï¸ Compliance & Safety
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ›¡ï¸ COMPLIANCE & SAFETY - Fraud, Disputes, Proofs"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Fraud Detection
          ./_curl.sh "${{ env.BACKEND_URL }}/fraud/scan" POST '{}' 60 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/fraud/stats" GET '' 30 | jq -c '{ok}' || true
          
          # Compliance
          ./_curl.sh "${{ env.BACKEND_URL }}/compliance/stats" GET '' 30 | jq -c '{ok}' || true
          
          # Disputes
          ./_curl.sh "${{ env.BACKEND_URL }}/disputes/auto-resolve" POST '{}' 60 | jq -c '{ok}' || true
          
          # Proofs
          ./_curl.sh "${{ env.BACKEND_URL }}/proofs/process-pending" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 33: INTERNET-WIDE DISCOVERY (Enhanced v99)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸŒ Internet-Wide Discovery
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸŒ INTERNET-WIDE DISCOVERY - Beyond 27 Platforms"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Vacuum Scraper (internet-wide)
          ./_curl.sh "${{ env.BACKEND_URL }}/autonomous/internet-discovery" POST '{"limit":50}' 180 | jq -c '{ok,found}' || true
          
          # Discovery with Contact Extraction
          ./_curl.sh "${{ env.BACKEND_URL }}/autonomous/discover-with-contacts" POST '{"limit":30}' 180 | jq -c '{ok,contacts_found}' || true
          
          # Alpha Discovery (27 platforms)
          ./_curl.sh "${{ env.BACKEND_URL }}/alpha-discovery/run" POST '{}' 180 | jq -c '{ok,total}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 34: METAHIVE INTELLIGENCE
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ§  MetaHive Intelligence
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ§  METAHIVE INTELLIGENCE - Cross-AI Learning"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Hive Stats & Learning
          ./_curl.sh "${{ env.BACKEND_URL }}/hive/stats" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/hive/top-patterns" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/hive/distribute" POST '{}' 60 | jq -c '{ok}' || true
          
          # Intelligence Collection
          ./_curl.sh "${{ env.BACKEND_URL }}/intelligence/collect" POST '{}' 120 | jq -c '{ok}' || true
          
          # Protocol Stats
          ./_curl.sh "${{ env.BACKEND_URL }}/protocol/stats" GET '' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 35: ANALYTICS & REPUTATION
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“Š Analytics & Reputation
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“Š ANALYTICS & REPUTATION"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Analytics
          ./_curl.sh "${{ env.BACKEND_URL }}/analytics/dashboard" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/analytics/daily-snapshot" POST '{}' 60 | jq -c '{ok}' || true
          
          # Reputation
          ./_curl.sh "${{ env.BACKEND_URL }}/reputation/wade" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/tiers/leaderboard" GET '' 30 | jq -c '{ok}' || true
          
          # Currency Rates
          ./_curl.sh "${{ env.BACKEND_URL }}/currency/rates" GET '' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 36: COMPREHENSIVE MATRIX TEST
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ”¬ Comprehensive Matrix Test
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ”¬ COMPREHENSIVE MATRIX TEST - 161 Endpoints"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Run full matrix test
          MATRIX=$(./_curl.sh "${{ env.BACKEND_URL }}/matrix/comprehensive" GET '' 120 2>/dev/null || echo '{}')
          echo "$MATRIX" | tee json/matrix.json | jq -c '.summary' 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 37: V101 CLOSE-LOOP ORCHESTRATORS
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ”„ V101 Close-Loop Orchestrators
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ”„ V101 CLOSE-LOOP ORCHESTRATORS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Check orchestrator status
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/status" GET '' 30 | jq -c '{ok,version,orchestrators}' || true
          
          # Intent-to-Cash (atomic close loop)
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/intent-to-cash" POST '{"intent_id":"auto","username":"wade","dry_run":true}' 120 | jq -c '{ok,won,amount}' || true
          
          # Inventory-Merch (commerce pipeline)
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/inventory-merch" POST '{"sku":"default","username":"wade","dry_run":true}' 120 | jq -c '{ok}' || true
          
          # JV Auto-Execute (partnership automation)
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/jv-auto-execute" POST '{"username":"wade","dry_run":true}' 120 | jq -c '{ok,suggestions_found,proposals_created}' || true
          
          # Franchise Autospawn (scale winners)
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/franchise-autospawn" POST '{"username":"wade","max_spawns":3,"dry_run":true}' 120 | jq -c '{ok,clones_created}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 38: NEW MODULES (IFX, OAA, SKILLS)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ†• New Modules (IFX, OAA, Skills)
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ†• NEW MODULES - IFX, OAA, SKILLS MARKETPLACE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # IFX (Intent Futures Exchange)
          echo "ğŸ“Š IFX - Intent Futures Exchange"
          ./_curl.sh "${{ env.BACKEND_URL }}/ifx/listings" GET '' 30 | jq -c '{ok,count}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/ifx/publish" POST '{"publisher":"wade","intent_type":"service","description":"test listing","min_bid":100}' 60 | jq -c '{ok}' || true
          
          # OAA (Outcome-as-an-API)
          echo "ğŸ”Œ OAA - Outcome-as-an-API"
          ./_curl.sh "${{ env.BACKEND_URL }}/oaa/quote" POST '{"outcome_type":"service","urgency":"normal"}' 30 | jq -c '{ok,quote}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/oaa/execute" POST '{"client_id":"test","outcome_type":"service","dry_run":true}' 120 | jq -c '{ok}' || true
          
          # Skills Marketplace
          echo "ğŸ“š Skills Marketplace"
          ./_curl.sh "${{ env.BACKEND_URL }}/skills/catalog" GET '' 30 | jq -c '{ok,count}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/skills/publish" POST '{"creator":"wade","name":"Test Skill","category":"automation","price":49}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 39: V102 COGS & MARGIN GATES
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’° V102 COGS & Margin Gates
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’° V102 COGS & MARGIN GATES - Stop losing $1 to make $0.90"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Estimate COGS for different SKUs
          ./_curl.sh "${{ env.BACKEND_URL }}/execution/estimate-cogs" POST '{"sku_type":"service","price":200}' 30 | jq -c '{ok,margin_pct,bid_recommended}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/execution/estimate-cogs" POST '{"sku_type":"video","price":500,"urgency":"urgent"}' 30 | jq -c '{ok,margin_pct}' || true
          
          # Margin gate check
          ./_curl.sh "${{ env.BACKEND_URL }}/execution/margin-gate" POST '{"price":200,"sku_type":"service","mode":"normal"}' 30 | jq -c '{ok,passed,margin_pct}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 40: V102 PLATFORM PACING & TOS
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸš¦ V102 Platform Pacing & TOS
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸš¦ V102 PLATFORM PACING - Avoid bans"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Check platform health
          ./_curl.sh "${{ env.BACKEND_URL }}/platform/health" GET '' 30 | jq -c '{ok,platforms}' || true
          
          # Pacing guards for each platform
          ./_curl.sh "${{ env.BACKEND_URL }}/platform/pacing-guard" POST '{"platform":"twitter","action_type":"message"}' 30 | jq -c '{ok,allowed,health}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/platform/pacing-guard" POST '{"platform":"reddit","action_type":"post"}' 30 | jq -c '{ok,allowed}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/platform/pacing-guard" POST '{"platform":"linkedin","action_type":"connect"}' 30 | jq -c '{ok,allowed}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 41: V102 CAPACITY FORECASTING
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“Š V102 Capacity Forecasting
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“Š V102 CAPACITY FORECASTING - Predict & Scale"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Forecast next 72h
          ./_curl.sh "${{ env.BACKEND_URL }}/capacity/forecast" POST '{"hours":72}' 60 | jq -c '{ok,total_predicted_cost,recommendations}' || true
          
          # Scale or shed spawns
          ./_curl.sh "${{ env.BACKEND_URL }}/spawn/scale-or-shed" POST '{"scale_threshold":80,"shed_threshold":20}' 60 | jq -c '{ok,actions}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 42: V102 PROVISION & PUBLISH
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ› ï¸ V102 Provision & Publish
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ› ï¸ V102 PROVISION & PUBLISH - Auto-ship storefronts"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Bootstrap infrastructure
          ./_curl.sh "${{ env.BACKEND_URL }}/provision/bootstrap" POST '{"template":"storefront"}' 120 | jq -c '{ok,status}' || true
          
          # Auto-publish storefronts
          ./_curl.sh "${{ env.BACKEND_URL }}/storefront/autopublish" POST '{"max":10,"source":"spawn"}' 120 | jq -c '{ok,published}' || true
          
          # Check provision status
          ./_curl.sh "${{ env.BACKEND_URL }}/provision/status" GET '' 30 | jq -c '{ok,total_provisioned}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 43: V102 SPONSOR POOLS & CO-OP
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ’¸ V102 Sponsor Pools & Co-op
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ’¸ V102 SPONSOR POOLS & CO-OP - Community dollars"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Get sponsor dashboard
          ./_curl.sh "${{ env.BACKEND_URL }}/sponsors/dashboard" GET '' 30 | jq -c '{ok}' || true
          
          # List sponsor pools
          ./_curl.sh "${{ env.BACKEND_URL }}/sponsors/pools/list" GET '' 30 | jq -c '{ok}' || true
          
          # Distribute sponsor funds
          ./_curl.sh "${{ env.BACKEND_URL }}/sponsors/distribute" POST '{}' 60 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 44: V102 BOOKS & TAX
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“’ V102 Books & Tax
        continue-on-error: true
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“’ V102 BOOKS & TAX - Reliable books for scale"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Persist reconciliation
          ./_curl.sh "${{ env.BACKEND_URL }}/reconciliation/persist" POST '{}' 30 | jq -c '{ok}' || true
          
          # Tax summary
          ./_curl.sh "${{ env.BACKEND_URL }}/tax/summary" GET '' 30 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/tax/earnings" GET '' 30 | jq -c '{ok}' || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 45: V102 POISON QUEUE & OAA SLA
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: â˜ ï¸ V102 Poison Queue & OAA SLA
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "â˜ ï¸ V102 POISON QUEUE & OAA SLA ENFORCEMENT"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Check poison queue
          POISON=$(./_curl.sh "${{ env.BACKEND_URL }}/queue/poison" GET '' 30 2>/dev/null || echo '{"ok":true,"count":0}')
          echo "$POISON" | jq -c '{ok,count,pending_retries}' || true
          
          # DRAIN: Retry recoverable items with backoff
          ./_curl.sh "${{ env.BACKEND_URL }}/queue/poison/retry" POST '{"max":50,"backoff_sec":300}' 60 | jq -c '{ok,retried}' 2>/dev/null || true
          
          # QUARANTINE: Move old failures to permanent quarantine
          ./_curl.sh "${{ env.BACKEND_URL }}/queue/poison/quarantine" POST '{"age_min_sec":3600}' 30 | jq -c '{ok,quarantined}' 2>/dev/null || true
          
          # Enforce OAA SLAs
          ./_curl.sh "${{ env.BACKEND_URL }}/oaa/sla-enforce" POST '{"check_all":true}' 60 | jq -c '{ok,violations,penalties_applied}' || true
          
          ./_log.sh "poison_queue" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 46: V102 ENHANCED PRECHECK & STATUS
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ›¡ï¸ V102 Enhanced Precheck & Status
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ›¡ï¸ V102 ENHANCED PRECHECK & STATUS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # Full precheck guard
          ./_curl.sh "${{ env.BACKEND_URL }}/orchestrator/precheck-guard" POST '{"intent_id":"test","platform":"twitter","action_type":"bid","price":200,"run_id":"${{ env.RUN_ID }}"}' 60 | jq -c '{ok,proceed,checks}' || true
          
          # V102 system status
          ./_curl.sh "${{ env.BACKEND_URL }}/v102/status" GET '' 30 | jq -c '{ok,version,systems}' || true
          
          # V103 status (new)
          ./_curl.sh "${{ env.BACKEND_URL }}/v103/status" GET '' 30 | jq -c '{ok,version}' || true
          
          ./_log.sh "precheck_status" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 47: HEALTH CHECKS
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ¥ Health Checks
        continue-on-error: true
        run: |
          PHASE_START=$(date +%s)
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¥ HEALTH CHECKS"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          ./_curl.sh "${{ env.BACKEND_URL }}/health" GET '' 10 | jq -c '{status}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/execution/health" GET '' 10 | jq -c '{ok}' || true
          ./_curl.sh "${{ env.BACKEND_URL }}/learning/health" GET '' 10 | jq -c '{ok}' || true
          
          ./_log.sh "health_checks" "true" "$(($(date +%s) - PHASE_START))000"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # CANARY ARTIFACT
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“¦ Revenue Canary Artifact
        if: always()
        run: |
          NOW=$(date -u '+%Y-%m-%dT%H:%M:%SZ')
          DASH=$(cat json/orch.json 2>/dev/null || echo '{}')
          WADE=$(cat json/wade-approve.json 2>/dev/null || echo '{}')
          SPAWN=$(cat json/spawn.json 2>/dev/null || echo '{}')
          V99_CHECK=$(cat json/v99-check.json 2>/dev/null || echo '{}')
          V99_CYCLE=$(cat json/v99-cycle.json 2>/dev/null || echo '{}')
          V99_REPLIES=$(cat json/v99-replies.json 2>/dev/null || echo '{}')
          V99_CONTRACTS=$(cat json/v99-contracts.json 2>/dev/null || echo '{}')
          MATRIX=$(cat json/matrix.json 2>/dev/null || echo '{}')
          NDJSON_LOG=$(cat logs/run.ndjson 2>/dev/null | jq -s '.' || echo '[]')
          
          cat > canary.json <<EOF
          {
            "ts": "$NOW",
            "version": "v104",
            "run_id": "${{ env.RUN_ID }}",
            "mode": "${{ env.RUN_MODE }}",
            "dry_run": ${{ env.DRY_RUN }},
            "cash": {
              "verified_6h": "${{ steps.cash.outputs.verified_6h }}",
              "scheduled_24h": "${{ steps.cash.outputs.scheduled_24h }}",
              "pipeline": "${{ steps.cash.outputs.pipeline }}",
              "mrr": "${{ steps.cash.outputs.mrr }}"
            },
            "aggression": {
              "level": "${{ steps.aggression.outputs.aggression }}",
              "mode": "${{ steps.aggression.outputs.mode }}"
            },
            "slo_violated": "${{ steps.slo.outputs.slo_violated }}",
            "orchestrator": $DASH,
            "wade": $WADE,
            "spawn": $SPAWN,
            "v99": {
              "system_check": $V99_CHECK,
              "cycle": $V99_CYCLE,
              "replies": $V99_REPLIES,
              "contracts": $V99_CONTRACTS
            },
            "matrix": $MATRIX,
            "observability": $NDJSON_LOG
          }
          EOF

      - name: â¬†ï¸ Upload Artifacts
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: autonomous-v104-${{ github.run_number }}
          path: |
            canary.json
            json/
            logs/
          retention-days: 14

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # STEP SUMMARY (v104)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“Š Step Summary
        if: always()
        run: |
          {
            echo "## ğŸ¦ AiGentsy v104 Run Summary"
            echo ""
            echo "| Metric | Value |"
            echo "|--------|-------|"
            echo "| ğŸ• Time | $(date -u '+%Y-%m-%d %H:%M:%S UTC') |"
            echo "| ğŸ”‘ Run ID | \`${{ env.RUN_ID }}\` |"
            echo "| ğŸ¯ Mode | ${{ env.RUN_MODE }} |"
            echo "| ğŸ§ª Dry Run | ${{ env.DRY_RUN }} |"
            echo ""
            echo "### ğŸ’° Cash Status"
            echo "| Metric | Value |"
            echo "|--------|-------|"
            echo "| Verified (6h) | \$${{ steps.cash.outputs.verified_6h }} |"
            echo "| Scheduled (24h) | \$${{ steps.cash.outputs.scheduled_24h }} |"
            echo "| Pipeline | \$${{ steps.cash.outputs.pipeline }} |"
            echo "| MRR | \$${{ steps.cash.outputs.mrr }} |"
            echo ""
            echo "### âš¡ System Status"
            echo "| Metric | Value |"
            echo "|--------|-------|"
            echo "| Aggression | ${{ steps.aggression.outputs.aggression }}/10 (${{ steps.aggression.outputs.mode }}) |"
            echo "| Max Bids | ${{ steps.aggression.outputs.max_bids }} |"
            echo "| Max Spawns | ${{ steps.aggression.outputs.max_spawns }} |"
            echo "| SLO Violated | ${{ steps.slo.outputs.slo_violated }} |"
            echo "| Budget OK | ${{ steps.config.outputs.budget_ok }} |"
            echo "| Platform Healthy | ${{ steps.config.outputs.platform_healthy }} |"
            echo ""
            echo "### ğŸ›¡ï¸ v104 Two-Job Architecture"
            echo "- âœ… All calls wrapped with \`timeout 55s\`"
            echo "- âœ… Budget gates on vacuum, sniper, spawn"
            echo "- âœ… Health gates on scrapers + engagement"
            echo "- âœ… AGG-tuned max_bids/max_spawns"
            echo "- âœ… SLO gate on viral (skip if SLO violated)"
          } >> "$GITHUB_STEP_SUMMARY"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # SUMMARY (Console output)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: ğŸ“ Summary
        if: always()
        run: |
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘       ğŸ¦ AIGENTSY v104 TWO-JOB ARCHITECTURE - COMPLETE            â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ ğŸ• $(date -u '+%Y-%m-%d %H:%M:%S UTC')                             â•‘"
          echo "â•‘ ğŸ”‘ RUN_ID: ${{ env.RUN_ID }}                                       â•‘"
          echo "â•‘ ğŸ¯ MODE: ${{ env.RUN_MODE }} | DRY_RUN: ${{ env.DRY_RUN }}         â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ ğŸ’“ CASH: verified=\$${{ steps.cash.outputs.verified_6h }} | sched=\$${{ steps.cash.outputs.scheduled_24h }}"
          echo "â•‘ ğŸ“Š PIPELINE: \$${{ steps.cash.outputs.pipeline }} | MRR: \$${{ steps.cash.outputs.mrr }}"
          echo "â•‘ âš¡ AGGRESSION: ${{ steps.aggression.outputs.aggression }}/10 (${{ steps.aggression.outputs.mode }})"
          echo "â•‘ ğŸ¯ MAX_BIDS: ${{ steps.aggression.outputs.max_bids }} | MAX_SPAWNS: ${{ steps.aggression.outputs.max_spawns }}"
          echo "â•‘ ğŸš¨ SLO VIOLATED: ${{ steps.slo.outputs.slo_violated }}"
          echo "â•‘ ğŸ’° BUDGET OK: ${{ steps.config.outputs.budget_ok }}"
          echo "â•‘ ğŸš¦ PLATFORM HEALTHY: ${{ steps.config.outputs.platform_healthy }}"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ ğŸ†• V104 TWO-JOB ARCHITECTURE:                                     â•‘"
          echo "â•‘   â±ï¸ All calls wrapped with timeout 55s                           â•‘"
          echo "â•‘   ğŸ’° Budget gates on vacuum, sniper, spawn                        â•‘"
          echo "â•‘   ğŸš¦ Health gates on scrapers + engagement                        â•‘"
          echo "â•‘   ğŸ¯ AGG-tuned max_bids (6/15/30) & max_spawns (1/3/5)           â•‘"
          echo "â•‘   ğŸš« SLO gate on viral (skip if SLO violated)                     â•‘"
          echo "â•‘   ğŸ“Š Outputs passed between jobs for coordination                 â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ ğŸ†• V103 PRODUCTION HARDENING (included):                          â•‘"
          echo "â•‘   ğŸ”„ cancel-in-progress: true | ğŸš¨ Critical phase protection      â•‘"
          echo "â•‘   ğŸ“Š \$GITHUB_STEP_SUMMARY | ğŸ“ ND-JSON observability              â•‘"
          echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
          echo "â•‘ ğŸ“ˆ TOTAL: 500+ ENDPOINTS | 48 PHASES | EVERY 15 MINUTES           â•‘"
          echo "â•‘ ğŸ¯ NOVELTY SCORE: 10/10 (production-hardened + AGG-tuned)         â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
